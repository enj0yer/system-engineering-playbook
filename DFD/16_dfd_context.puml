@startuml DFD_Context
!define RECTANGLE class

title DFD Уровень 0 (Контекстная диаграмма) - Система умного КПП

skinparam roundcorner 20
skinparam defaultTextAlignment center

' Внешние сущности
actor "Сотрудник охраны" as guard #LightBlue
actor "Администратор" as admin #LightBlue
actor "HR менеджер" as hr #LightBlue
actor "Пользователь\n(сотрудник/посетитель)" as user #LightBlue

' Внешние системы
database "IP-камеры" as cameras #LightGreen
database "Контроллеры\nдоступа" as controllers #LightGreen
database "Внешние системы\n(ERP, Time tracking)" as external #LightGreen

' Центральная система
circle "**Система\nумного КПП**\n\n(Процесс 0)" as system #Orange

' Потоки данных от внешних сущностей к системе
cameras --> system : "D1: Видеопотоки\n(RTSP)"
user --> system : "D2: Физическое\nприсутствие"
hr --> system : "D3: Данные для\nрегистрации"
admin --> system : "D4: Настройки\nи конфигурация"
guard --> system : "D5: Ручные\nкоманды"

' Потоки данных от системы к внешним сущностям
system --> guard : "D6: События\nв реальном времени"
system --> admin : "D7: Отчеты\nи аналитика"
system --> hr : "D8: Статус\nрегистрации"
system --> controllers : "D9: Команды\nуправления (OPEN/CLOSE)"
system --> external : "D10: Данные\nо проходах"
system --> guard : "D11: Алерты\nи уведомления"

note right of system
  **Центральный процесс**:
  Управление контрольно-пропускным пунктом
  
  **Основные функции**:
  1. Регистрация пользователей
  2. Распознавание лиц и авто
  3. Контроль доступа
  4. Аудит и логирование
  
  **Технологии**: 
  Python, FastAPI, Kafka, 
  PostgreSQL, Redis, MinIO
end note

@enduml
