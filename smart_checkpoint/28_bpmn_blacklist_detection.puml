@startuml BPMN_BlacklistDetection

title BPMN - Сценарий обнаружения лица из черного списка

|Система распознавания|
start
:Распознать лицо\nна КПП;
:User ID получен\nс confidence 0.98;

|Система контроля доступа|
:Получить событие\nраспознавания;

:Проверить в\nчерном списке;

if (Найден в blacklist?) then (да)
  :Немедленно DENY;
  
  :Определить\nсерьезность угрозы;
  
  if (Причина блокировки?) then (критическая)
    :Severity: HIGH;
  else (временная)
    :Severity: MEDIUM;
  endif
  
  fork
    |Система уведомлений|
    :Отправить алерт\nохране (Telegram);
    
    :Отправить push\nна мобильное приложение;
    
    |Оператор охраны|
    :Получить алерт\nс фото и причиной;
    
    :Оценить ситуацию;
    
    if (Требуется\nвмешательство?) then (да)
      :Вызвать охрану\nна место;
      
      |Служба безопасности|
      :Прибыть на КПП;
      
      :Проверить\nличность;
      
      :Действовать согласно\nпротоколу;
      
      |Оператор охраны|
      :Зафиксировать\nрезультат;
    else (нет)
      :Наблюдать\nза ситуацией;
    endif
    
  fork again
    |Система аудита|
    :Логировать инцидент\n(HIGH priority);
    
    :Сохранить\nвидеозапись (5 мин);
    
    :Сохранить все\nкадры с лицом;
    
  fork again
    |Система контроля доступа|
    :Заблокировать\nповторные попытки;
    
    :Добавить в\ntemporary ban (1 час);
    
  fork again
    |Система аналитики|
    :Инкремент счетчика\nblacklist_detections;
    
    :Обновить дашборд\nбезопасности;
    
  end fork
  
  |Пользователь (нарушитель)|
  :Доступ категорически\nзапрещен;
  
  :Сообщение на экране:\n"Обратитесь в\nслужбу безопасности";
  
  stop
  
else (нет)
  :Продолжить\nстандартные проверки;
  
  note right
    Переход к проверке
    прав доступа, временных
    ограничений и т.д.
  end note
  
  stop
endif

@enduml
